<section class="relative min-h-screen pt-10 pb-20 px-6 md:px-20 text-neutral-50 overflow-x-clip">
  <div
    class="absolute top-80 -left-[150px] w-[600px] h-[600px] rounded-full bg-primary-500 opacity-25 blur-[100px]"
  ></div>
  <!-- Background Decorations -->
  <div
    class="absolute bottom-0 left-0 w-[400px] h-[400px] bg-secondary-500 blur-[120px] rounded-full -z-10 animate-pulse"
  ></div>

  <div class="max-w-[1450px] mx-auto text-center mb-16">
    <div
      class="inline-flex items-center gap-2 bg-primary-500/10 border border-primary-500/20 px-4 py-2 rounded-full mb-8 animate-bounce"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-5 h-5 text-primary-400"
        viewBox="0 0 20 20"
        fill="currentColor"
      >
        <path
          fill-rule="evenodd"
          d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
          clip-rule="evenodd"
        />
      </svg>
      <span class="text-primary-400 text-xs md:text-sm font-bold uppercase tracking-wider"
        >Todo el código se entrega, eres dueño de tu web</span
      >
    </div>
    <h2 class="text-primary-400 font-bold uppercase tracking-[0.3em] text-sm mb-4 animate-fade-in">
      Soluciones Benitech
    </h2>
    <h1
      class="uppercase text-4xl sm:text-6xl md:text-7xl text-primary-500 font-black text-shadow-md text-shadow-primary-600"
    >
      <span class="text-text-primary">Cotizador de</span> Servicios
    </h1>
    <p class="text-neutral-400 text-lg md:text-xl max-w-2xl mx-auto mt-6">
      Selecciona los servicios que necesitas para tu próximo proyecto tecnológico. Calcula tu
      presupuesto y contáctanos vía WhatsApp para hacer realidad tu idea.
    </p>
  </div>

  <div class="max-w-[1450px] mx-auto grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
    @for (product of services(); track product.id) {
      <div
        class="group bg-white/5 border border-white/10 rounded-4xl p-8 hover:border-primary-500/50 hover:bg-white/10 transition-all duration-500 flex flex-col h-full relative overflow-hidden"
      >
        <!-- Card Backdrop Glow -->
        <div
          class="absolute -top-24 -right-24 w-48 h-48 bg-primary-500/20 blur-[60px] rounded-full group-hover:bg-primary-500/40 transition-all duration-500"
        ></div>

        <div class="mb-6 relative">
          <div
            class="w-16 h-16 bg-primary-500/20 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 group-hover:rotate-6 transition-transform duration-500"
          >
            @if (product.id === 'web-pages') {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-primary-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"
                />
              </svg>
            } @else if (product.id === 'mobile-apps') {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-primary-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"
                />
              </svg>
            } @else if (product.id === 'ecommerce') {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-primary-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                />
              </svg>
            } @else if (product.id === 'admin-web-apps') {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-primary-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                />
              </svg>
            } @else {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-8 h-8 text-primary-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
                />
              </svg>
            }
          </div>
          <h3 class="text-2xl font-bold mb-4 group-hover:text-primary-400 transition-colors">
            {{ product.name }}
          </h3>
          <p class="text-xs uppercase font-bold text-neutral-500 mb-2 tracking-widest">
            {{ product.examplesLabel }}
          </p>
          <p class="text-neutral-400 mb-6 leading-relaxed">{{ product.description }}</p>
        </div>

        <div class="mb-8 grow">
          <p class="text-xs uppercase font-bold text-neutral-500 mb-4 tracking-widest">Incluye:</p>
          <ul class="space-y-3 mb-8">
            @for (item of product.scope; track item) {
              <li class="flex items-center gap-3 text-neutral-300">
                <div
                  class="w-1.5 h-1.5 bg-primary-500 rounded-full shadow-[0_0_10px_rgba(8,170,214,0.5)]"
                ></div>
                {{ item }}
              </li>
            }
          </ul>

          @if (product.addons && product.addons.length > 0) {
            <p
              class="text-xs uppercase font-bold text-neutral-500 mb-4 tracking-widest border-t border-white/5 pt-6"
            >
              Personalización (Añadidos):
            </p>
            <div class="space-y-3">
              @for (addon of product.addons; track addon.id) {
                <label
                  (click)="$event.stopPropagation()"
                  class="flex items-start gap-3 p-3 rounded-xl border border-white/5 hover:bg-white/5 cursor-pointer transition-colors group/addon"
                  [class.bg-primary-500/10]="isAddonSelected(product.id, addon.id)"
                  [class.border-primary-500/30]="isAddonSelected(product.id, addon.id)"
                >
                  <div class="relative flex items-center mt-1">
                    <input
                      type="checkbox"
                      [checked]="isAddonSelected(product.id, addon.id)"
                      (change)="toggleAddonSelection(product.id, addon.id)"
                      class="peer appearance-none w-5 h-5 border-2 border-white/20 rounded-md checked:bg-primary-500 checked:border-primary-500 transition-all cursor-pointer"
                    />
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="absolute w-5 h-5 text-neutral-950 opacity-0 peer-checked:opacity-100 pointer-events-none transition-opacity"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </div>
                  <div class="flex flex-col text-left">
                    <span
                      class="text-sm font-bold text-neutral-200 group-hover/addon:text-primary-400 transition-colors"
                      >{{ addon.name }}</span
                    >
                    <span class="text-xs text-neutral-500"
                      >+ $ {{ addon.price.toLocaleString() }}</span
                    >
                  </div>
                </label>
              }
            </div>
          }
        </div>

        <div class="mt-auto pt-8 border-t border-white/10 flex items-center justify-between">
          <div class="flex flex-col">
            <span class="text-neutral-500 text-xs uppercase font-bold tracking-wider">
              {{ selectedAddonsState()[product.id]?.length ? 'Total Servicio' : 'Desde' }}
            </span>
            <span class="text-2xl font-black text-white">
              $ {{ getServiceTotalPrice(product).toLocaleString() }}
            </span>
          </div>

          <button
            (click)="toggleCart(product)"
            [class.bg-red-500]="isInCart(product.id)"
            [class.hover:bg-red-400]="isInCart(product.id)"
            [class.bg-primary-500]="!isInCart(product.id)"
            [class.hover:bg-primary-400]="!isInCart(product.id)"
            class="flex items-center justify-center gap-2 px-6 py-3 rounded-2xl font-bold transition-all active:scale-95 shadow-lg shadow-primary-500/20 group/btn"
          >
            {{ isInCart(product.id) ? 'Quitar' : 'Agregar' }}
            @if (isInCart(product.id)) {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                />
              </svg>
            } @else {
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5 group-hover/btn:translate-x-1 transition-transform"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4v16m8-8H4"
                />
              </svg>
            }
          </button>
        </div>
      </div>
    }
  </div>
</section>

<!-- Floating Cart Footer -->
<div
  class="fixed bottom-6 left-1/2 -translate-x-1/2 z-40 w-[calc(100%-2rem)] max-w-[800px] transition-all duration-500"
  [class.translate-y-40]="cartService.totalItems() === 0"
  [class.translate-y-0]="cartService.totalItems() > 0"
>
  <div
    class="bg-primary-800/40 backdrop-blur-2xl border border-white/20 rounded-3xl sm:rounded-[2.5rem] p-4 sm:p-6 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4 sm:gap-6 overflow-hidden relative"
  >
    <div class="absolute inset-0 bg-linear-to-r from-primary-500/5 to-secondary-500/5 -z-10"></div>

    <div class="flex items-center gap-4 sm:gap-6">
      <div
        class="w-12 h-12 sm:w-16 sm:h-16 bg-primary-500 rounded-2xl flex items-center justify-center relative shrink-0"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-6 h-6 sm:w-8 sm:h-8 text-neutral-950"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
          />
        </svg>
        <span
          class="absolute -top-2 -right-2 bg-white text-neutral-950 font-black text-xs px-2 py-1 rounded-lg border-2 border-neutral-900"
          >{{ cartService.totalItems() }}</span
        >
      </div>
      <div class="flex flex-col min-w-0">
        <span
          class="text-neutral-400 text-[9px] sm:text-xs uppercase font-bold tracking-widest sm:tracking-[0.2em] truncate"
          >Presupuesto Estimado</span
        >
        <span class="text-xl sm:text-3xl font-black text-white whitespace-nowrap"
          >$ {{ cartService.totalPrice().toLocaleString() }}</span
        >
      </div>
    </div>

    <div class="flex items-center gap-2 sm:gap-4 w-full md:w-auto">
      <button
        (click)="cartService.clearCart()"
        class="flex-1 md:flex-none px-3 sm:px-6 py-3 sm:py-4 rounded-xl sm:rounded-2xl font-bold bg-white/5 hover:bg-white/10 text-neutral-300 transition-all border border-white/10 text-xs sm:text-base whitespace-nowrap"
      >
        Vaciar
      </button>
      <button
        (click)="cartService.sendToWhatsApp()"
        class="grow md:grow-0 px-4 sm:px-8 py-3 sm:py-4 bg-primary-500 hover:bg-primary-400 text-white font-black rounded-xl sm:rounded-2xl flex items-center justify-center gap-2 sm:gap-3 transition-all active:scale-95 shadow-xl shadow-primary-500/30 text-xs sm:text-base whitespace-nowrap"
      >
        COTIZAR
        <span class="hidden xs:inline">AHORA</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-4 h-4 sm:w-6 sm:h-6"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.89 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.743-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
          />
        </svg>
      </button>
    </div>
  </div>
</div>
